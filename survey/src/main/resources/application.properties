

# ============================================================================
# Survey Microservice - Application Configuration
# ============================================================================
# This properties file contains all configuration for Spring Boot, PostgreSQL,
# Redis, JPA, and application-specific settings.
# ============================================================================

# ============================================================================
# Server Configuration
# ============================================================================
# Tomcat server port
server.port=8080
# Server context path (optional, currently using root context)
server.servlet.context-path=/

# ============================================================================
# Spring Application Configuration
# ============================================================================
# Application name
spring.application.name=survey

# ============================================================================
# PostgreSQL Database Configuration
# ============================================================================
# Database URL: Format - jdbc:postgresql://host:port/database
# Change 'localhost' and 'survey_db' as per your local/production setup
spring.datasource.url=jdbc:postgresql://localhost:5432/survey_db
# Database username
spring.datasource.username=survey_user
# Database password
spring.datasource.password=survey_password
# PostgreSQL JDBC driver class name
spring.datasource.driver-class-name=org.postgresql.Driver

# ============================================================================
# HikariCP Connection Pool Configuration
# ============================================================================
# HikariCP is the default connection pool in Spring Boot
# Maximum number of connections in the pool
spring.datasource.hikari.maximum-pool-size=20
# Minimum idle connections to maintain
spring.datasource.hikari.minimum-idle=5
# Maximum idle time (in milliseconds) before connection is closed
spring.datasource.hikari.idle-timeout=600000
# Connection timeout (in milliseconds)
spring.datasource.hikari.connection-timeout=30000
# Leak detection threshold (in milliseconds) - 0 disables
spring.datasource.hikari.leak-detection-threshold=0

# ============================================================================
# JPA / Hibernate Configuration
# ============================================================================
# Hibernate dialect for PostgreSQL
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
# JPA provider (Hibernate)
spring.jpa.provider=org.hibernate.jpa.HibernateJpaProvider
# DDL strategy: 'validate' - verify schema matches entities, 'update' - create/update tables
# For production, use 'validate'; for development, use 'update'
spring.jpa.hibernate.ddl-auto=update
# Show SQL queries in logs (disable in production)
spring.jpa.show-sql=false
# Format SQL queries for readability
spring.jpa.properties.hibernate.format_sql=true
# Use PostgreSQL-specific JDBC batch fetching
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
# Enable JSONB column type support for PostgreSQL
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQL15Dialect
# Open in view: false to prevent lazy loading exceptions in web layer (recommended for microservices)
spring.jpa.open-in-view=false

# ============================================================================
# Redis Configuration
# ============================================================================
# Redis server host
spring.redis.host=localhost
# Redis server port
spring.redis.port=6379
# Redis password (empty if no authentication)
spring.redis.password=
# Redis database index (default: 0)
spring.redis.database=0
# Redis client type (lettuce is default)
spring.redis.client-type=lettuce
# Connection pool configuration
spring.redis.lettuce.pool.max-active=8
spring.redis.lettuce.pool.max-idle=8
spring.redis.lettuce.pool.min-idle=0
spring.redis.lettuce.pool.max-wait=-1ms
spring.redis.lettuce.shutdown-timeout=100ms

# ============================================================================
# Logging Configuration
# ============================================================================
# Root logger level (OFF, ERROR, WARN, INFO, DEBUG, TRACE)
logging.level.root=INFO
# Survey application logger level (more verbose for debugging)
logging.level.com.survey=DEBUG
# Spring Data JPA logger level
logging.level.org.springframework.data.jpa=DEBUG
# Hibernate logger level
logging.level.org.hibernate=WARN
# SQL logging with parameter values (debug Spring Data)
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE
# Log pattern for console and file
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %logger{36} - %msg%n
logging.file.name=logs/survey-microservice.log

# ============================================================================
# Jackson Configuration (JSON Serialization/Deserialization)
# ============================================================================
# Include non-null properties in JSON output
spring.jackson.default-property-inclusion=non_null
# Date format for JSON serialization
spring.jackson.serialization.write-dates-as-timestamps=false
spring.jackson.time-zone=UTC
# Pretty print JSON responses
spring.jackson.serialization.indent-output=false

# ============================================================================
# Servlet Configuration
# ============================================================================
# Character encoding for HTTP requests/responses
server.servlet.encoding.charset=UTF-8
# Enable character encoding for request body
server.servlet.encoding.enabled=true
# Force charset to UTF-8
server.servlet.encoding.force=true

# ============================================================================
# Application-Specific Configuration
# ============================================================================
# Survey expiry check interval (in seconds) - how often to check expired surveys
app.survey.expiry-check-interval=3600
# Default survey cache TTL (in seconds) - how long survey definitions stay in Redis
app.survey.cache-ttl=3600
# Maximum file upload size (in MB)
app.file.max-upload-size=10
# Allowed file extensions for upload (comma-separated)
app.file.allowed-extensions=pdf,doc,docx,xls,xlsx,jpg,jpeg,png,gif,txt
# Survey session timeout (in minutes) - time a survey response session remains active
app.survey.session-timeout=120

# ============================================================================
# Actuator Configuration (Monitoring & Health Checks)
# ============================================================================
# Enable actuator endpoints
management.endpoints.web.exposure.include=health,info,metrics
# Health endpoint verbosity
management.endpoint.health.show-details=when-authorized
# Metrics export (optional, useful for monitoring)
management.metrics.enable.all=true

# ============================================================================
# Error Handling
# ============================================================================
# Include error details in responses
server.error.include-message=always
server.error.include-binding-errors=always
server.error.include-stacktrace=on_param
server.error.include-exception=false

# ============================================================================
# Deployment Profiles
# ============================================================================
# Active profiles: local (default), dev, prod
# Use: spring.profiles.active=prod (in environment or VM argument)
# This allows environment-specific configurations
